FROM balenalib/raspberry-pi-debian:buster
RUN apt update
RUN apt -y full-upgrade
RUN apt -yq install python python3-pip pigpio python-pigpio python3-pigpio wget
RUN pip3 install --upgrade setuptools
RUN pip3 install RPI.GPIO gpiozero adafruit-blinka adafruit-io --quiet
COPY docker/install-java.sh /install-java.sh
RUN chmod u+x /install-java.sh && /install-java.sh
EXPOSE 8080/tcp
ENV LOG_LEVEL=debug
ENV TZ=Europe/Berlin
ENV DEMOMODE=false

COPY backend/target/server.jar /app.jar

ENTRYPOINT ["java","-jar","/app.jar"]
