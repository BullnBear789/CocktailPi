FROM balenalib/raspberry-pi-debian:buster
RUN apt update
RUN apt -y full-upgrade
RUN apt -yq install python python3-pip pigpio python-pigpio python3-pigpio wget alsa-utils
COPY docker/install-java.sh /install-java.sh
RUN chmod u+x /install-java.sh && /install-java.sh

EXPOSE 8080/tcp
ENV LOG_LEVEL=debug
ENV TZ=Europe/Berlin
ENV DEMOMODE=false
ENV IS_RASPBERRY_PI=true
ENV DB_HOST=db
ENV DB_PORT=5432

COPY backend/target/server.jar /app.jar

CMD ["java -jar /app.jar"]
